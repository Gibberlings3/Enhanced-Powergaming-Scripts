LOAD_TRA ~enhanced-powergaming-scripts/languages/%LANGUAGE%/script_dialog.tra~

///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
// Add Mod Components to Normal Scripts                                  //
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
// MO-Core Initial                                                       //
///////////////////////////////////////////////////////////////////////////
COPY ~enhanced-powergaming-scripts/baf/normal/mocore.baf~  ~enhanced-powergaming-scripts/baf/upload/mocore.baf~
INCLUDE ~enhanced-powergaming-scripts/lib/IWDEE/prebuff_iwd.tph~

///////////////////////////////////////////////////////////////////////////
// Turn Undead Overhaul                                                  //
///////////////////////////////////////////////////////////////////////////
ACTION_IF turn_undead BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/bg2ee/prebuff_turn_undead.tph~
END

///////////////////////////////////////////////////////////////////////////
// Remove Dialog Hovertext from Scripts                                  //
///////////////////////////////////////////////////////////////////////////
ACTION_IF scp_dlg BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/ini/prebuff_dialog.tph~
END

///////////////////////////////////////////////////////////////////////////
// Hotkey Setup                                                          //
///////////////////////////////////////////////////////////////////////////
INCLUDE ~enhanced-powergaming-scripts/lib/core_hotkey.tph~

///////////////////////////////////////////////////////////////////////////
// Build out MO-Core                                                     //
///////////////////////////////////////////////////////////////////////////
INCLUDE ~enhanced-powergaming-scripts/lib/core_base.tph~
INCLUDE ~enhanced-powergaming-scripts/lib/iwdee/core_iwd.tph~

///////////////////////////////////////////////////////////////////////////
// Turn Undead Overhaul                                                  //
///////////////////////////////////////////////////////////////////////////
ACTION_IF turn_undead BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/bg2ee/core_turn_undead.tph~
	INCLUDE ~enhanced-powergaming-scripts/lib/iwdee/core_turn_undead_iwd.tph~
END

INCLUDE ~enhanced-powergaming-scripts/lib/ini/remove_wight.tph~

///////////////////////////////////////////////////////////////////////////
// Update ini Presets                                                    //
///////////////////////////////////////////////////////////////////////////
	// Removes Dialog Hovertext from Scripts
	ACTION_IF scp_dlg BEGIN
		INCLUDE ~enhanced-powergaming-scripts/lib/ini/core_dialog.tph~
	END

	// Fast Healing
	ACTION_IF fst_heal BEGIN
		INCLUDE ~enhanced-powergaming-scripts/lib/ini/core_fast_healing.tph~
	END

///////////////////////////////////////////////////////////////////////////
// Thieving Skills for Bards                                             //
///////////////////////////////////////////////////////////////////////////
ACTION_IF bard_thief BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/bard_thief.tph~
END

///////////////////////////////////////////////////////////////////////////
// Turn Undead Overhaul - END                                            //
///////////////////////////////////////////////////////////////////////////
ACTION_IF turn_undead BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/bg2ee/core_turn_undead_end.tph~
END

///////////////////////////////////////////////////////////////////////////
// Skills and Abilities Paladin Overhaul                                 //
///////////////////////////////////////////////////////////////////////////
ACTION_IF pally_smite BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/BG2EE/core_pally_smite.tph~
	INCLUDE ~enhanced-powergaming-scripts/lib/IWDEE/core_pally_smite_iwd.tph~
	INCLUDE ~enhanced-powergaming-scripts/lib/BGEE/core_pally_smite_check.tph~
END

///////////////////////////////////////////////////////////////////////////
// Skills and Abilities Psi Warrior                                      //
///////////////////////////////////////////////////////////////////////////
ACTION_IF psi_warrior BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/BG2EE/core_psi_warrior.tph~
	INCLUDE ~enhanced-powergaming-scripts/lib/IWDEE/core_psi_warrior_iwd.tph~
	INCLUDE ~enhanced-powergaming-scripts/lib/BG2EE/core_psi_warrior_check.tph~
END

///////////////////////////////////////////////////////////////////////////
// Skills and Abilities Eldritch Scion                                   //
///////////////////////////////////////////////////////////////////////////
ACTION_IF eldritch_scion BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/BG2EE/core_eldritch_scion.tph~
END

///////////////////////////////////////////////////////////////////////////
// Skills and Abilities Fighter Updates                                  //
///////////////////////////////////////////////////////////////////////////
ACTION_IF fighter_overhaul BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/BG2EE/core_sa_wind.tph~
END

///////////////////////////////////////////////////////////////////////////
// EEex Check                                                            //
///////////////////////////////////////////////////////////////////////////
ACTION_IF eeex_present BEGIN
	COPY ~enhanced-powergaming-scripts/lua/m_actri1.lua~  ~override~ 
	COPY ~enhanced-powergaming-scripts/lua/m_actri2.lua~  ~override~
END ELSE BEGIN
	INCLUDE ~enhanced-powergaming-scripts/lib/core_eeex.tph~
END

///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
// Import AI Scripts into the Game                                       //
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
// Copy .BS files to scripts folder                                      //
///////////////////////////////////////////////////////////////////////////
COPY ~enhanced-powergaming-scripts/baf/upload/mocore.baf~   ~scripts/mocore.bs~
  COMPILE_BAF_TO_BCS

///////////////////////////////////////////////////////////////////////////
// Add descriptions of the scripts to scrpdesc.2da                       //
///////////////////////////////////////////////////////////////////////////
APPEND ~scrpdesc.2DA~
~mocore      mcore1       mcore2~

///////////////////////////////////////////////////////////////////////////
// Copy the appended scrpdesc.2da to the override folder                 //
///////////////////////////////////////////////////////////////////////////
COPY_EXISTING ~scrpdesc.2da~ ~override~
REPLACE ~mcore1~  @1112
REPLACE ~mcore2~  @1122


///////////////////////////////////////////////////////////////////////////
// Update UI Menu                                                        //
///////////////////////////////////////////////////////////////////////////
OUTER_SPRINT uiold1 @2000
OUTER_SPRINT uinew1 @2001
OUTER_SPRINT uiold2 @2002
OUTER_SPRINT uinew2 @2003

COPY_EXISTING "UI.MENU" ~override~
	REPLACE_TEXTUALLY ~%uiold1 %~ ~%uinew1%~
	REPLACE_TEXTUALLY ~%uiold2 %~ ~%uinew2%~

/*
Replace: ~currentPanelID = const.SCRIPT_ID

		showingSmartOptions = false~

With: ~currentPanelID = const.SCRIPT_ID

		showingSmartOptions = (scriptList_idx == 23)
		scriptDescription = t(scriptOptions[scriptList_idx][2])~

Replace: ~showingSmartOptions = false
			if scriptList[scriptList_idx] ~= '' then~

With: ~showingSmartOptions = (scriptList_idx == 23)
			if scriptList[scriptList_idx] ~= '' then~
*/