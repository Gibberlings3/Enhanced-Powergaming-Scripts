// **********************************************************************
// *           Segment Name: mocore.baf
// **********************************************************************
// *
// * mocore.baf
// * -----------
// * AI Script for:             BG2EE & BGEET
// * Written by:                Mark Evinger (morpheus562)
// * Version:                   Version 3.0 (20 May 2021)
// * Comments to:               mark.evinger@hotmail.com
// * Depends on:                BG2EE/BGEET
// *							Spell Revisions
//
//
// * Description:
// * This script is designed for all core classes: Fighter, Mage, Thief, Cleric, Druid, and 
// * any combination of multiclass/dualclass to include kits. This script will constantly 
// * Turn Undead when the V key is pressed and will cast pre-buffing spells when the D key 
// * is pressed. If the character is able, the script will constantly be detecting traps.

IF
	PartyRested()
THEN
	RESPONSE #100
		SetGlobal("MO_UsedIbratha","LOCALS",0)
		SetGlobal("MO_UsedDuplication","LOCALS",0)
		SetGlobal("MO_UsedGargoyle","LOCALS",0)
		SetGlobal("MO_UsedCheetah","LOCALS",0)
END

IF
	OR(7)
		AreaCheck("AR0700")  // Waukeen's Promenade
		AreaCheck("AR0020")  // City Gates
		AreaCheck("AR0800")  // Graveyard
		AreaCheck("AR0400")  // Slums
		AreaCheck("AR0300")  // The Docks
		AreaCheck("AR1000")  // Government District
		AreaCheck("AR0900")  // Temple District
	Global("BRIBEDCOWLED","GLOBAL",0)
	GlobalLT("CowledWarning","GLOBAL",7)
	Global("MO_CastAthkatla","LOCALS",1)
THEN
	RESPONSE #100
		SetGlobal("MO_CastAthkatla","LOCALS",0)
END

IF
	!AreaCheck("AR0700")  // Waukeen's Promenade
	!AreaCheck("AR0020")  // City Gates
	!AreaCheck("AR0800")  // Graveyard
	!AreaCheck("AR0400")  // Slums
	!AreaCheck("AR0300")  // The Docks
	!AreaCheck("AR1000")  // Government District
	!AreaCheck("AR0900")  // Temple District
	Global("MO_CastAthkatla","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("MO_CastAthkatla","LOCALS",1)
END

IF
	OR(2)
		Global("BRIBEDCOWLED","GLOBAL",1)
		Global("CowledWarning","GLOBAL",7)
	Global("MO_CastAthkatla","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("MO_CastAthkatla","LOCALS",1)
END

IF
	Global("MO_TURNUNDEAD","LOCALS",0)
	Class(Myself,CLERIC_ALL)
	HotKey(V)
THEN
	RESPONSE #100
		SetGlobal("MO_TURNUNDEAD","LOCALS",1)
		DisplayStringHead(Myself,50702)  // Turning Undead
END

IF
	Global("MO_TURNUNDEAD","LOCALS",1)
	HotKey(V)
THEN
	RESPONSE #100
		SetGlobal("MO_TURNUNDEAD","LOCALS",0)
		DisplayStringHead(Myself,50703)  // Stopped Turning Undead
END

IF
	Global("MO_BUFF","LOCALS",0)
	HotKey(D)
THEN
	RESPONSE #50
		SetGlobal("MO_BUFF","LOCALS",1)
		DisplayStringHead(Myself,91061)  // Right. I'll get started then.
	RESPONSE #50
		SetGlobal("MO_BUFF","LOCALS",1)
		DisplayStringHead(Myself,91057)  // Right, I'll get started then. Please excuse me.
END

IF
	Global("MO_BUFF","LOCALS",1)
	OR(2)
		HotKey(D)
		See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("MO_BUFF","LOCALS",0)
		DisplayStringHead(Myself,50742)  // I have not yet completed the task.
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn09",Myself)  // Potion of Heroism
	!CheckSpellState(Myself,BUFF_ENHANCEMENT)
THEN
	RESPONSE #100
		UseItem("potn09",Myself)  // Potion of Heroism
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn02",Myself)  // Potion of Fire Resistance
THEN
	RESPONSE #100
		UseItem("potn02",Myself)  // Potion of Fire Resistance
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn22",Myself)  // Potion of Cold Resistance
THEN
	RESPONSE #100
		UseItem("potn22",Myself)  // Potion of Cold Resistance
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn18",Myself)  // Potion of Absorption
	CheckStatLT(Myself,100,RESISTELECTRICITY)
THEN
	RESPONSE #100
		UseItem("potn18",Myself)  // Potion of Absorption
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn34",Myself)  // Potion of Magic Blocking
THEN
	RESPONSE #100
		UseItem("potn34",Myself)  // Potion of Magic Blocking
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn07",Myself)  // Potion of Storm Giant Strength
	CheckStatLT(Myself,24,STR)
THEN
	RESPONSE #100
		UseItem("potn07",Myself)  // Potion of Storm Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn06",Myself)  // Potion of Cloud Giant Strength
	CheckStatLT(Myself,23,STR)
THEN
	RESPONSE #100
		UseItem("potn06",Myself)  // Potion of Cloud Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn05",Myself)  // Potion of Fire Giant Strength
	CheckStatLT(Myself,22,STR)
THEN
	RESPONSE #100
		UseItem("potn05",Myself)  // Potion of Fire Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn04",Myself)  // Potion of Frost Giant Strength
	CheckStatLT(Myself,21,STR)
THEN
	RESPONSE #100
		UseItem("potn04",Myself)  // Potion of Frost Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn12",Myself)  // Potion of Stone Giant Strength
	CheckStatLT(Myself,20,STR)
THEN
	RESPONSE #100
		UseItem("potn12",Myself)  // Potion of Stone Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn03",Myself)  // Potion of Hill Giant Strength
	CheckStatLT(Myself,19,STR)
THEN
	RESPONSE #100
		UseItem("potn03",Myself)  // Potion of Hill Giant Strength
END

IF
	Global("MO_BUFF","LOCALS",1)
	HasItemEquiped("potn11",Myself)  // Potion of Invulnerability
	CheckStatGT(Myself,0,ARMORCLASS)
THEN
	RESPONSE #100
		UseItem("potn11",Myself)  // Potion of Invulnerability
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	GlobalLT("MO_UsedIbratha","LOCALS",1)
	HasItemEquiped("SW1H26",Myself)  // Ilbratha +1
THEN
	RESPONSE #100
		UseItemAbility("SW1H26",Myself,SLOT_AMMO3,1)  // Ilbratha +1
		IncrementGlobal("MO_UsedIbratha","LOCALS",1)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	GlobalLT("MO_UsedDuplication","LOCALS",3)
	HasItemEquiped("OHRRING1",Myself)  // Ring of Duplication
THEN
	RESPONSE #100
		UseItem("OHRRING1",Myself)  // Ring of Duplication
		IncrementGlobal("MO_UsedDuplication","LOCALS",1)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection from Magic Energy)
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection from Magic Energy)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // sppr521.spl (Protection from Fire)
	CheckStatLT(Myself,80,RESISTFIRE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_PROTECTION_FROM_FIRE)  // sppr521.spl (Protection from Fire)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(Myself)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See([GOODCUTOFF])
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(SecondNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(ThirdNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(FourthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(FifthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	See(SixthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(Myself)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See([GOODCUTOFF])
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(SecondNearest([GOODCUTOFF]))
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(ThirdNearest([GOODCUTOFF]))
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(FourthNearest([GOODCUTOFF]))
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(FifthNearest([GOODCUTOFF]))
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	See(SixthNearest([GOODCUTOFF]))
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(Myself)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See([GOODCUTOFF])
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(SecondNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(ThirdNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(FourthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(FifthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	See(SixthNearest([GOODCUTOFF]))
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	!CheckSpellState(LastSeenBy(Myself),LEVEL_DRAIN_IMMUNITY)
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +4
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	!CheckSpellState(Myself,RESIST_FEAR)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	OR(6)
		!CheckSpellState(Myself,RESIST_FEAR)
		!CheckSpellState(NearestAllyOf(Myself),RESIST_FEAR)
		!CheckSpellState(SecondNearestAllyOf(Myself),RESIST_FEAR)
		!CheckSpellState(ThirdNearestAllyOf(Myself),RESIST_FEAR)
		!CheckSpellState(FourthNearestAllyOf(Myself),RESIST_FEAR)
		!CheckSpellState(FifthNearestAllyOf(Myself),RESIST_FEAR)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Magic Circle Against Evil)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Magic Circle Against Evil)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
	!CheckSpellState(Myself,ARMOR_OF_FAITH)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
	!StateCheck(Myself,STATE_BLESS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_BLESS)  // SPPR101.SPL (Bless)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection from the Elements)
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_THE_ELEMENTS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection from the Elements)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection from Missiles)
	!CheckSpellState(Myself,PROTECTION_FROM_NORMAL_MISSILES)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection from Missiles)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_PHYSICAL_MIRROR)  // SPPR613.SPL (Physical Mirror)
	CheckStatLT(Myself,1,CLERIC_PHYSICAL_MIRROR)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_PHYSICAL_MIRROR)  // SPPR613.SPL (Physical Mirror)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
	!CheckSpellState(Myself,SPELL_SHIELD)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_GREATER_SPELL_DEFLECTION)  // SPWI701.SPL (Greater Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_GREATER_SPELL_DEFLECTION)  // SPWI701.SPL (Greater Spell Deflection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_SPELL_DEFLECTION)  // SPWI522.SPL (Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_SPELL_DEFLECTION)  // SPWI522.SPL (Spell Deflection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStat(Myself,1,PUPPETTYPE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_DISPELLING_SCREEN)  // spwi525.spl (Dispelling Screen)
	!CheckSpellState(Myself,DISPEL_SCREEN)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_DISPELLING_SCREEN)  // spwi525.spl (Dispelling Screen)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpellRES("SPIN103")  // Draw Upon Divine Might
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,25,STR)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SpellRES("SPIN103",Myself)  // Draw Upon Divine Might
END

IF
	Global("MO_BUFF","LOCALS",1)
	HaveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
	!StateCheck(Myself,STATE_CHANT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_CHANT)  // SPPR203.SPL (Chant)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Divine Might)
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,25,STR)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Divine Might)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpellRES("SPIN103")  // Draw Upon Divine Might
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,25,STR)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SpellRES("SPIN103",Myself)  // Draw Upon Divine Might
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_DEFENSIVE_HARMONY)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
END

IF
	Global("MO_BUFF","LOCALS",1)
	HaveSpell(CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
	CheckStatLT(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,89,RESISTFIRE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
	!CheckSpellState(Myself,BERSERKER_RAGE_FATIGUE)
	!CheckSpellState(Myself,BERSERKER_RAGE)
THEN
	RESPONSE #100
		Spell(Myself,BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection from Energy)
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_ENERGY)
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_THE_ELEMENTS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection from Energy)
END

IF
	Global("MO_BUFF","LOCALS",1)
	HaveSpell(CLERIC_MAGIC_RESISTANCE)  // SPPR509.SPL (Magic Resistance)
	CheckStatLT(Myself,20,RESISTMAGIC)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_MAGIC_RESISTANCE)  // SPPR509.SPL (Magic Resistance)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_MESTILS_ACID_SHEATH)  // SPWI524.spl (Mestil's Acid Sheath)
	!CheckSpellState(Myself,RED_FIRESHIELD)
	!CheckSpellState(Myself,ACID_SHEATH)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_MESTILS_ACID_SHEATH)  // SPWI524.spl (Mestil's Acid Sheath)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield)
	!CheckSpellState(Myself,RED_FIRESHIELD)
	!CheckSpellState(Myself,ACID_SHEATH)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
	!StateCheck(Myself,STATE_HASTED)
	CheckStat(Myself,0,IMPROVEDHASTE)
	!StateCheck(Myself,STATE_NOT_TARGETABLE)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_HASTE)  // SPWI305.SPL (Haste)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	!CheckStatGT(Myself,0,IMPROVEDHASTE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
	Global("MO_BUFF","LOCALS",1)
	HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Fury)
	!CheckSpellState(Myself,RIGHTEOUS_MAGIC)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Fury)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
	CheckStatLT(Myself,1,WIZARD_SPELL_TRAP)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
END

IF
	Global("MO_BUFF","LOCALS",1)
	IfValidForPartyDialog(Myself)
	HaveSpell(WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
	!CheckSpellState(Myself,HARDINESS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		Spell(Myself,WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
END

IF
	Global("MO_BUFF","LOCALS",1)
THEN
	RESPONSE #100
		SetGlobal("MO_BUFF","LOCALS",0)
		DisplayStringHead(Myself,421)  // Combat ready!
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(2)
		StateCheck(Myself,STATE_POISONED)
		CheckSpellState(Myself,DISEASED)
	HasItemEquiped("POTN17",Myself)  // Elixir of Health
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("POTN17",Myself)  // Elixir of Health
		DisplayString(Myself,46150)  // *quaffs a potion*
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(Myself,STATE_POISONED)
	HasItemEquiped("POTN20",Myself)  // Potion of Antidote
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("POTN20",Myself)  // Potion of Antidote
		DisplayString(Myself,46150)  // *quaffs a potion*
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(NearestEnemyOf(Myself))
	StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	HaveSpell(WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_ABSOLUTE_IMMUNITY)  // SPWI907.SPL (Absolute Immunity)
	!CheckSpellState(Myself,PROTECTION_FROM_MAGICAL_WEAPONS)
	!CheckSpellState(Myself,ABSOLUTE_IMMUNITY)
	!CheckSpellState(Myself,MANTLE)
	!CheckSpellState(Myself,IMPROVED_MANTLE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_ABSOLUTE_IMMUNITY)  // SPWI907.SPL (Absolute Immunity)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection from Magical Weapons)
	!CheckSpellState(Myself,PROTECTION_FROM_MAGICAL_WEAPONS)
	!CheckSpellState(Myself,ABSOLUTE_IMMUNITY)
	!CheckSpellState(Myself,MANTLE)
	!CheckSpellState(Myself,IMPROVED_MANTLE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection from Magical Weapons)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_MOMENT_OF_PRESCIENCE)  // SPWI808.SPL (Moment of Prescience)
	!CheckSpellState(Myself,PROTECTION_FROM_MAGICAL_WEAPONS)
	!CheckSpellState(Myself,ABSOLUTE_IMMUNITY)
	!CheckSpellState(Myself,MANTLE)
	!CheckSpellState(Myself,IMPROVED_MANTLE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MOMENT_OF_PRESCIENCE)  // SPWI808.SPL (Moment of Prescience)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	IfValidForPartyDialog(Myself)
	HaveSpell(WIZARD_MANTLE)  // SPWI708.SPL (Prismatic Mantle)
	!CheckSpellState(Myself,PROTECTION_FROM_MAGICAL_WEAPONS)
	!CheckSpellState(Myself,ABSOLUTE_IMMUNITY)
	!CheckSpellState(Myself,MANTLE)
	!CheckSpellState(Myself,IMPROVED_MANTLE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MANTLE)  // SPWI708.SPL (Prismatic Mantle)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	CheckStatLT(Myself,1,STONESKINS)
	HaveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
		SetInterrupt(TRUE)
END

IF
  ActionListEmpty()
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpell(CLERIC_IRONSKIN)  // SPPR506.SPL (Stoneskin)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    Spell(Myself,CLERIC_IRONSKIN)  // SPPR506.SPL (Stoneskin)
END

IF
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	CheckStatLT(Myself,1,STONESKINS)
	GlobalLT("MO_UsedGargoyle","LOCALS",2)
	HasItemEquiped("Boot12",Myself)  // Gargoyle Boots
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("Boot12",Myself)  // Gargoyle Boots
		IncrementGlobal("MO_UsedGargoyle","LOCALS",1)
END

IF
	CheckStatLT(Myself,1,STONESKINS)
	GlobalLT("MO_UsedGargoyle","LOCALS",2)
	HasItem("Boot12",Myself)  // Gargoyle Boots
	HasItemEquiped("Boot01",Myself)  // Boots of Speed
THEN
	RESPONSE #100
		XEquipItem("Boot12",Myself,SLOT_BOOTS,EQUIP)  // Gargoyle Boots
END

IF
	OR(2)
		CheckStatGT(Myself,0,STONESKINS)
		GlobalGT("MO_UsedGargoyle","LOCALS",1)
	HasItem("Boot01",Myself)  // Boots of Speed
	HasItemEquiped("Boot12",Myself)  // Gargoyle Boots
THEN
	RESPONSE #100
		XEquipItem("Boot01",Myself,SLOT_BOOTS,EQUIP)  // Boots of Speed
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	!See([EVILCUTOFF])
	HaveSpell(WIZARD_ARMOR)  // SPWI102.SPL (Mage Armor)
	!CheckSpellState(Myself,MAGE_ARMOR)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_ARMOR)  // SPWI102.SPL (Mage Armor)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	!See([EVILCUTOFF])
	HaveSpell(WIZARD_MIND_BLANK)  // SPWI802.SPL (Mind Blank)
	!CheckSpellState(Myself,MIND_BLANK)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MIND_BLANK)  // SPWI802.SPL (Mind Blank)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	HasItemEquiped("POTN55",Myself)  // Potion of Superior Healing
	ActuallyInCombat()
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("POTN55",Myself)  // Potion of Superior Healing
		DisplayString(Myself,46150)  // *quaffs a potion*
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	HasItemEquiped("POTN52",Myself)  // Potion of Extra Healing
	ActuallyInCombat()
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("POTN52",Myself)  // Potion of Extra Healing
		DisplayString(Myself,46150)  // *quaffs a potion*
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([EVILCUTOFF])
	HPPercentLT(Myself,51)
	HasItemEquiped("POTN08",Myself)  // Potion of Healing
	ActuallyInCombat()
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("POTN08",Myself)  // Potion of Healing
		DisplayString(Myself,46150)  // *quaffs a potion*
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(NearestEnemyOf(Myself))
	HaveSpell(CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
	!StateCheck(Myself,STATE_INVISIBLE)
	!CheckStat(Myself,1,SANCTUARY)
	HPPercentLT(Myself,20)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_MASS_RAISE_DEAD)  // SPPR729.SPL (Mass Raise Dead)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
	OR(2)
		HPPercentLT(Myself,51)
		HPPercentLT([PC],51)
	OR(2)
		HPPercentLT(SecondNearest([PC]),51)
		HPPercentLT(ThirdNearest([PC]),51)
	OR(2)
		Range([PC],12)
		Range(SecondNearest([PC]),12)
	OR(2)
		Range(ThirdNearest([PC]),12)
		HPPercentLT(Myself,51)
	OR(2)
		StateCheck(Player1,STATE_REALLY_DEAD)
		StateCheck(Player2,STATE_REALLY_DEAD)
	OR(2)
		StateCheck(Player1,STATE_REALLY_DEAD)
		StateCheck(Player3,STATE_REALLY_DEAD)
	OR(2)
		StateCheck(Player2,STATE_REALLY_DEAD)
		StateCheck(Player3,STATE_REALLY_DEAD)
	OR(2)
		StateCheck(Player4,STATE_REALLY_DEAD)
		StateCheck(Player5,STATE_REALLY_DEAD)
	OR(2)
		StateCheck(Player4,STATE_REALLY_DEAD)
		StateCheck(Player6,STATE_REALLY_DEAD)
	OR(2)
		StateCheck(Player5,STATE_REALLY_DEAD)
		StateCheck(Player6,STATE_REALLY_DEAD)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_MASS_RAISE_DEAD)  // SPPR729.SPL (Mass Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player1,STATE_REALLY_DEAD)
	InPartyAllowDead(Player1)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player1,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player2,STATE_REALLY_DEAD)
	InPartyAllowDead(Player2)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player2,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player3,STATE_REALLY_DEAD)
	InPartyAllowDead(Player3)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player3,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player4,STATE_REALLY_DEAD)
	InPartyAllowDead(Player4)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player4,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player5,STATE_REALLY_DEAD)
	InPartyAllowDead(Player5)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player5,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	StateCheck(Player6,STATE_REALLY_DEAD)
	InPartyAllowDead(Player6)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player6,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player1,STATE_REALLY_DEAD)
	InPartyAllowDead(Player1)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player1,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player2,STATE_REALLY_DEAD)
	InPartyAllowDead(Player2)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player2,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player3,STATE_REALLY_DEAD)
	InPartyAllowDead(Player3)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player3,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player4,STATE_REALLY_DEAD)
	InPartyAllowDead(Player4)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player4,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player5,STATE_REALLY_DEAD)
	InPartyAllowDead(Player5)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player5,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
	StateCheck(Player6,STATE_REALLY_DEAD)
	InPartyAllowDead(Player6)
	CombatCounter(0)
	!Range([EVILCUTOFF],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Player6,CLERIC_RAISE_DEAD)  // SPPR504.SPL (Raise Dead)
		SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player1,STATE_REALLY_DEAD)
  InPartyAllowDead(Player1)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player1)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player2,STATE_REALLY_DEAD)
  InPartyAllowDead(Player2)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player2)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player3,STATE_REALLY_DEAD)
  InPartyAllowDead(Player3)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player3)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player4,STATE_REALLY_DEAD)
  InPartyAllowDead(Player4)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player4)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player5,STATE_REALLY_DEAD)
  InPartyAllowDead(Player5)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player5)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpellRES("SPJA01")  // Harper's Call
  StateCheck(Player6,STATE_REALLY_DEAD)
  InPartyAllowDead(Player6)
  CombatCounter(0)
  !Range([EVILCUTOFF],30)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    SpellRES("SPJA01",Player6)  // Harper's Call
    SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(Nearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(SecondNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(ThirdNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(FourthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(FifthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
	See(SixthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_BREAK_ENCHANTMENT)  // SPPR307.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(Nearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(SecondNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(ThirdNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(FourthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(FifthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
	See(SixthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_SILENCED)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREAK_ENCHANTMENT)  // SPWI410.SPL (Break Enchantment)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Myself)
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Nearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FifthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SixthNearest([PC]))
	OR(8)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Myself)
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Nearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FifthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SixthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([GOODCUTOFF])
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	See(FifthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	See(SixthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([GOODCUTOFF])
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([GOODCUTOFF]))
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([GOODCUTOFF]))
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([GOODCUTOFF]))
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FifthNearest([GOODCUTOFF]))
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SixthNearest([GOODCUTOFF]))
	OR(6)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Myself)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([PC])
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([PC]))
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([PC]))
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([PC]))
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FifthNearest([PC]))
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SixthNearest([PC]))
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		StateCheck(LastSeenBy(Myself),STATE_DISEASED)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(Myself)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See([PC])
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SecondNearest([PC]))
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(ThirdNearest([PC]))
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FourthNearest([PC]))
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(FifthNearest([PC]))
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	See(SixthNearest([PC]))
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(Myself)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(Nearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck([GOODCUTOFF],STATE_PANIC)
	See([GOODCUTOFF])
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_PANIC)
	See(SecondNearest([GOODCUTOFF]))
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_PANIC)
	See(ThirdNearest([GOODCUTOFF]))
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FourthNearest([GOODCUTOFF]))
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FifthNearest([GOODCUTOFF]))
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_PANIC)
	See(SixthNearest([GOODCUTOFF]))
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_GUST_OF_WIND)  // SPPR318.SPL (Zone of Sweet Air)
	OR(13)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_ACID_FOG)  // SPWI614.SPL (Acid Fog)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_ACID_FOG)  // SPWI614.SPL (Acid Fog)
		SpellCast([EVILCUTOFF.0.0.SHAMAN],CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
		SpellCast([EVILCUTOFF.0.0.MEPHIT],MEPHIT_STINKING_CLOUD)  // SPIN940.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF],TRAP_STINKING_CLOUD)  // SPWI004.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF],SPORE_DEATH)  // SPIN673.SPL (Cloudkill)
		SpellCast([EVILCUTOFF],TRAP_CLOUDKILL)  // SPWI016.SPL (Cloudkill)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_GUST_OF_WIND)  // SPPR318.SPL (Zone of Sweet Air)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	OR(6)
		SpellCast([EVILCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
		SpellCast([EVILCUTOFF],WIZARD_SIMULACRUM)  // SPWI804.SPL (Simulacrum)
		SpellCast([EVILCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		SpellCast([EVILCUTOFF],WIZARD_SHADOW_DOOR)  // SPWI505.SPL (Shadow Door)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	Detect([EVILCUTOFF])
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(NearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(SecondNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(ThirdNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(FourthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(FifthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
	See(SixthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	OR(6)
		SpellCast([EVILCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
		SpellCast([EVILCUTOFF],WIZARD_SIMULACRUM)  // SPWI804.SPL (Simulacrum)
		SpellCast([EVILCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		SpellCast([EVILCUTOFF],WIZARD_SHADOW_DOOR)  // SPWI505.SPL (Shadow Door)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	Detect([EVILCUTOFF])
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(NearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(SecondNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(ThirdNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(FourthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(FifthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	See(SixthNearestEnemyOf(Myself))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	Detect([EVILCUTOFF])
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(NearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(SecondNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(ThirdNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(FourthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(FifthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	See(SixthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	Detect([EVILCUTOFF])
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(NearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(SecondNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(ThirdNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(FourthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(FifthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	See(SixthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStatLT(Myself,1,TRUE_SIGHT)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_SHIELD)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_KHELBANS_WARDING_WHIP)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	CheckStatLT(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	OR(5)
		CheckSpellState(LastSeenBy(Myself),GLOBE)
		CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
		CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(FourthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(FifthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(SixthNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(4)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
	CheckStatLT(LastSeenBy(Myself),1,SANCTUARY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
  !HasItem("melfmet",Myself)  // Short Sword
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    SetInterrupt(FALSE)
    Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
    SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	OR(2)
		!See([EVILCUTOFF])
		CheckStat(Myself,1,SANCTUARY)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),40)
	IfValidForPartyDialog(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	OR(2)
		!See([EVILCUTOFF])
		CheckStat(Myself,1,SANCTUARY)
	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Critical Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),60)
	IfValidForPartyDialog(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Critical Wounds)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	OR(2)
		!See([EVILCUTOFF])
		CheckStat(Myself,1,SANCTUARY)
	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Serious Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),70)
	IfValidForPartyDialog(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Serious Wounds)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	OR(2)
		!See([EVILCUTOFF])
		CheckStat(Myself,1,SANCTUARY)
	HaveSpell(CLERIC_CURE_MODERATE_WOUNDS)  // sppr215.spl (Cure Moderate Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),80)
	IfValidForPartyDialog(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_MODERATE_WOUNDS)  // sppr215.spl (Cure Moderate Wounds)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	OR(2)
		!See([EVILCUTOFF])
		CheckStat(Myself,1,SANCTUARY)
	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),90)
	IfValidForPartyDialog(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
	!CheckSpellState(LastSeenBy(Myself),GLOBE)
	!CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),SPELL_DEFLECTION)
	!CheckSpellState(LastSeenBy(Myself),GREATER_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(LastSeenBy(Myself),CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
	!CheckSpellState(Myself,SPELL_SHIELD)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
	CheckStatLT(Myself,1,WIZARD_SPELL_TRAP)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(WIZARD_GREATER_SPELL_DEFLECTION)  // SPWI701.SPL (Greater Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_GREATER_SPELL_DEFLECTION)  // SPWI701.SPL (Greater Spell Deflection)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(WIZARD_SPELL_DEFLECTION)  // SPWI522.SPL (Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_SPELL_DEFLECTION)  // SPWI522.SPL (Spell Deflection)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
	!CheckSpellState(Myself,GREATER_SPELL_DEFLECTION)
	!CheckSpellState(Myself,SPELL_DEFLECTION)
	!CheckSpellState(Myself,MINOR_SPELL_DEFLECTION)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
	See([EVILCUTOFF])
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,89,RESISTFIRE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
	See([EVILCUTOFF])
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_MESTILS_ACID_SHEATH)  // SPWI524.spl (Mestil's Acid Sheath)
	See([EVILCUTOFF])
	OR(19)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.DRUID_ALL])
	!CheckSpellState(Myself,RED_FIRESHIELD)
	!CheckSpellState(Myself,ACID_SHEATH)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MESTILS_ACID_SHEATH)  // SPWI524.spl (Mestil's Acid Sheath)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield)
	See([EVILCUTOFF])
	OR(19)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.DRUID_ALL])
	!CheckSpellState(Myself,RED_FIRESHIELD)
	!CheckSpellState(Myself,ACID_SHEATH)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	OR(17)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
		See([ENEMY.0.0.MAGE_ALL])
	HaveSpell(CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
	CheckStatLT(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection from Missiles)
	OR(11)
		HitBy([ANYONE],MISSILE)
		IsWeaponRanged(NearestEnemyOf(Myself))
		IsWeaponRanged(SecondNearestEnemyOf(Myself))
		IsWeaponRanged(ThirdNearestEnemyOf(Myself))
		IsWeaponRanged(FourthNearestEnemyOf(Myself))
		IsWeaponRanged(FifthNearestEnemyOf(Myself))
		IsWeaponRanged(SixthNearestEnemyOf(Myself))
		IsWeaponRanged(SeventhNearestEnemyOf(Myself))
		IsWeaponRanged(EighthNearestEnemyOf(Myself))
		IsWeaponRanged(NinthNearestEnemyOf(Myself))
		IsWeaponRanged(TenthNearestEnemyOf(Myself))
	!CheckSpellState(Myself,PROTECTION_FROM_NORMAL_MISSILES)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection from Missiles)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_PHYSICAL_MIRROR)  // SPPR613.SPL (Physical Mirror)
	OR(11)
		HitBy([ANYONE],MISSILE)
		IsWeaponRanged(NearestEnemyOf(Myself))
		IsWeaponRanged(SecondNearestEnemyOf(Myself))
		IsWeaponRanged(ThirdNearestEnemyOf(Myself))
		IsWeaponRanged(FourthNearestEnemyOf(Myself))
		IsWeaponRanged(FifthNearestEnemyOf(Myself))
		IsWeaponRanged(SixthNearestEnemyOf(Myself))
		IsWeaponRanged(SeventhNearestEnemyOf(Myself))
		IsWeaponRanged(EighthNearestEnemyOf(Myself))
		IsWeaponRanged(NinthNearestEnemyOf(Myself))
		IsWeaponRanged(TenthNearestEnemyOf(Myself))
	CheckStatLT(Myself,1,CLERIC_PHYSICAL_MIRROR)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_PHYSICAL_MIRROR)  // SPPR613.SPL (Physical Mirror)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
	See([EVILCUTOFF])
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Divine Might)
	See([EVILCUTOFF])
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,25,STR)
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Divine Might)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpellRES("SPIN103")  // Draw Upon Divine Might
	See([EVILCUTOFF])
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,25,STR)
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		SpellRES("SPIN103",Myself)  // Draw Upon Divine Might
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
	!CheckSpellState(Myself,ARMOR_OF_FAITH)
	See([EVILCUTOFF])
	OR(28)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // sppr521.spl (Protection from Fire)
	OR(7)
		Class(NearestEnemyOfType,MAGE_ALL)
		Class(NearestEnemyOfType,SORCERER)
		Class(NearestEnemyOfType,DRUID_ALL)
		Class(NearestEnemyOfType,CLERIC_ALL)
		Class(NearestEnemyOfType,ELEMENTAL_FIRE)
		Class(NearestEnemyOfType,RED_DRAGON)
		Class(NearestEnemyOfType,SILVER_DRAGON)
	CheckStatLT(Myself,80,RESISTFIRE)
	CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,CLERIC_PROTECTION_FROM_FIRE)  // sppr521.spl (Protection from Fire)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
	See(NearestEnemyOf(Myself))
	NumCreatureGT([EVILCUTOFF],3)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(EighthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(NinthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(TenthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
	!CheckStat(Myself,1,PUPPETTYPE)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	GlobalLT("MO_UsedIbratha","LOCALS",1)
	HasItemEquiped("SW1H26",Myself)  // Ilbratha +1
	See(NearestEnemyOf(Myself))
	OR(11)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItemAbility("SW1H26",Myself,SLOT_AMMO3,1)  // Ilbratha +1
		IncrementGlobal("MO_UsedIbratha","LOCALS",1)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	GlobalLT("MO_UsedDuplication","LOCALS",3)
	HasItemEquiped("OHRRING1",Myself)  // Ring of Duplication
	See(NearestEnemyOf(Myself))
	OR(11)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("OHRRING1",Myself)  // Ring of Duplication
		IncrementGlobal("MO_UsedDuplication","LOCALS",1)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
	!CheckSpellState(Myself,BERSERKER_RAGE_FATIGUE)
	!CheckSpellState(Myself,BERSERKER_RAGE)
	See([EVILCUTOFF])
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		Spell(Myself,BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
	!CheckSpellState(Myself,BARBARIAN_RAGE)
	See([EVILCUTOFF])
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		Spell(Myself,BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
END

IF
  ActionListEmpty()
  IfValidForPartyDialog(Myself)
  !GlobalTimerNotExpired("MO_SpellCast","LOCALS")
  HaveSpell(KENSAI_KIA)  // SPCL144.SPL (Kai)
  !CheckSpellState(Myself,KENSAI_KIA)
  See([EVILCUTOFF])
  OR(6)
    WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
    WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
    WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
    WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
    WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
    WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
  OR(6)
    WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
    WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
    WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
    WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
    WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
    WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
  OR(34)
    NumCreatureGT([EVILCUTOFF],3)
    Range([EVILCUTOFF.0.GOLEM],30)
    Range([EVILCUTOFF.0.MIST],30)
    Range([EVILCUTOFF.0.KUO-TOA],30)
    Range([EVILCUTOFF.0.GENIE],30)
    Range([EVILCUTOFF.0.GITHYANKI],30)
    Range([EVILCUTOFF.0.RAKSHASA],30)
    Range([EVILCUTOFF.0.VAMPYRE],30)
    Range([EVILCUTOFF.0.MIND_FLAYER],30)
    Range([EVILCUTOFF.0.DRAGON],30)
    Range([EVILCUTOFF.0.DEMONIC],30)
    Range([EVILCUTOFF.0.BEHOLDER],30)
    Range([EVILCUTOFF.0.UMBERHULK],30)
    Range([EVILCUTOFF.0.MYCONID],30)
    Range([EVILCUTOFF.0.VAMPIRE],30)
    Range([EVILCUTOFF.0.LICH],30)
    Range([EVILCUTOFF.0.DEMILICH],30)
    Range([EVILCUTOFF.0.FAIRY],30)
    Range([EVILCUTOFF.0.0.WRAITH],30)
    Range([EVILCUTOFF.0.0.WIGHT],30)
    Range([EVILCUTOFF.0.0.SPECTRE],30)
    Range([EVILCUTOFF.0.0.WYVERN],30)
    Range([EVILCUTOFF.0.0.BASILISK],30)
    Range([EVILCUTOFF.0.LICH],30)
    Range([EVILCUTOFF.0.SOLAR],30)
    Range([EVILCUTOFF.0.PLANATAR],30)
    Range([EVILCUTOFF.0.ANTISOLAR],30)
    Range([EVILCUTOFF.0.DARKPLANATAR],30)
    See([ENEMY.0.0.MAGE_ALL])
    See([ENEMY.0.0.BARD_ALL])
    See([ENEMY.0.0.CLERIC_ALL])
    See([ENEMY.0.0.DRUID_ALL])
    See([ENEMY.0.0.SORCERER])
    See([ENEMY.0.0.CLERIC_MAGE])
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
    Spell(Myself,KENSAI_KIA)  // SPCL144.SPL (Kai)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WARRIOR_GREATER_WHIRLWIND)  // SPCL901.SPL (Greater Whirlwind Attack)
	!CheckSpellState(Myself,GREATER_WHIRLWIND)
	See([EVILCUTOFF])
	OR(6)
		WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(6)
		WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		Spell(Myself,WARRIOR_GREATER_WHIRLWIND)  // SPCL901.SPL (Greater Whirlwind Attack)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	!CheckStatGT(Myself,0,IMPROVEDHASTE)
	!CheckSpellState(Myself,GREATER_WHIRLWIND)
	See([EVILCUTOFF])
	OR(6)
		WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(6)
		WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		SetInterrupt(FALSE)
		Spell(Myself,WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	IfValidForPartyDialog(Myself)
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	GlobalLT("MO_UsedCheetah","LOCALS",1)
	HasItemEquiped("AMUL26",Myself)  // Amulet of Cheetah Speed
	!CheckStatGT(Myself,0,IMPROVEDHASTE)
	!CheckSpellState(Myself,GREATER_WHIRLWIND)
	See([EVILCUTOFF])
	OR(6)
		WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(6)
		WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		UseItem("AMUL26",Myself)  // Amulet of Cheetah Speed
		IncrementGlobal("MO_UsedCheetah","LOCALS",1)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("MO_SpellCast","LOCALS")
	HaveSpell(WIZARD_TRUE_STRIKE)  // SPWI111.SPL (True Strike)
	See([EVILCUTOFF])
	OR(6)
		WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(6)
		WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
		WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	OR(34)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.GOLEM],30)
		Range([EVILCUTOFF.0.MIST],30)
		Range([EVILCUTOFF.0.KUO-TOA],30)
		Range([EVILCUTOFF.0.GENIE],30)
		Range([EVILCUTOFF.0.GITHYANKI],30)
		Range([EVILCUTOFF.0.RAKSHASA],30)
		Range([EVILCUTOFF.0.VAMPYRE],30)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.0.WYVERN],30)
		Range([EVILCUTOFF.0.0.BASILISK],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.SOLAR],30)
		Range([EVILCUTOFF.0.PLANATAR],30)
		Range([EVILCUTOFF.0.ANTISOLAR],30)
		Range([EVILCUTOFF.0.DARKPLANATAR],30)
		See([ENEMY.0.0.MAGE_ALL])
		See([ENEMY.0.0.BARD_ALL])
		See([ENEMY.0.0.CLERIC_ALL])
		See([ENEMY.0.0.DRUID_ALL])
		See([ENEMY.0.0.SORCERER])
		See([ENEMY.0.0.CLERIC_MAGE])
	!CheckSpellState(Myself,TRUE_STRIKE)
	!CheckSpellState(Myself,MINOR_GLOBE)
	!CheckSpellState(Myself,GLOBE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("MO_CastAthkatla","LOCALS",1)
	!CheckSpellState(Myself,WILD_MAGIC_AREA)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("MO_SpellCast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_STRIKE)  // SPWI111.SPL (True Strike)
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",1)
	!CheckStat(Myself,1,SANCTUARY)
	Class(Myself,CLERIC_ALL)
	!ModalState(TURNUNDEAD)
THEN
	RESPONSE #100
		Turn()
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(NearestEnemyOf(Myself))
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(NearestEnemyOf(Myself))
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(SecondNearestEnemyOf(Myself))
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(SecondNearestEnemyOf(Myself))
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(ThirdNearestEnemyOf(Myself))
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(ThirdNearestEnemyOf(Myself))
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(FourthNearestEnemyOf(Myself))
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(FourthNearestEnemyOf(Myself))
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(FifthNearestEnemyOf(Myself))
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(FifthNearestEnemyOf(Myself))
END

IF
	ActionListEmpty()
	Global("MO_TURNUNDEAD","LOCALS",0)
	!CheckStat(Myself,1,SANCTUARY)
	See(SixthNearestEnemyOf(Myself))
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		Attack(SixthNearestEnemyOf(Myself))
END

IF
  ActionListEmpty()
  IfValidForPartyDialog(Myself)
  !See([EVILCUTOFF])
  !ModalState(DETECTTRAPS)
  !ModalState(STEALTH)
  OR(3)
    Class(Myself,THIEF_ALL)
    Class(Myself,MONK)
    Class(Myself,SHAMAN)
THEN
  RESPONSE #100
    FindTraps()
END
